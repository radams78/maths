\chapter{Set Theory}

\section{Membership}

We take as undefined the binary relation of \emph{membership}, $\in$. If $a \in A$ we say $a$ is a \emph{member} or \emph{element} of $A$.
If this does not hold, we write $a \notin A$.

\begin{axiom}[Axiom of Extensionality]
    Two sets with exactly the same elements are equal.
\end{axiom}

\section{Subsets}

\begin{definition}[Subset]
    Let $A$ and $B$ be sets. We say $A$ is a \emph{subset} of $B$, $A \subseteq B$, if and only if every member of $A$ is a member of $B$.    
\end{definition}

\section{Abstraction Notation}

\begin{definitions}[Extensionality]
    Let $P(x)$ be a property. If there is a set whose members are exactly the sets $x$ such that $P(x)$, then we denote this set by $\{ x \mid P(x) \}$.

    It is unique by the Axiom of Extensionality.
\end{definitions}

\section{The Empty Set}

\begin{axiom}[Empty Set Axiom]
    There exists a set with no members.
\end{axiom}

\begin{definition}[Empty Set (Extensionality, Empty Set Axiom)]
    The \emph{empty set} $\emptyset$ is the set with no members $\{ x \mid \bot \}$.
\end{definition}

\section{Pair Sets}

\begin{axiom}[Pairing Axiom]
    For any sets $u$ and $v$, there exists a set having as members just $u$ and $v$.
\end{axiom}

\begin{definition}[Pair Set (Extensionality, Pairing Axiom)]
    For any sets $u$ and $v$, the \emph{pair set} $\{ u, v \}$ is the set $\{ x \mid x = u \vee x = v \}$.   
\end{definition}

\section{Unions}

\begin{axiom}[Union Axiom]
    For any set $A$, there exists a set whose elements are exactly the members of the members of $A$.
\end{axiom}

\begin{definition}[Union (Extensionality, Union)]
    For any set $A$, the \emph{union} $\bigcup A$ is the set $\{ x \mid \exists b \in A. x \in b \}$.
\end{definition}

\begin{definition}[Union (Extensionality, Pair Set, Union)]
    For any sets $a$ and $b$, the \emph{union} $a \cup b$ is the set $\bigcup \{ a, b \}$.
\end{definition}

\section{Power Set}

\begin{axiom}[Power Set Axiom]
    For any set $a$, there is a set whose members are exactly the subsets of $a$.    
\end{axiom}

\begin{definition}[Power Set (Extensionality, Power Set)]
    For any set $a$, the \emph{power set} $\pow a$ is the set $\{ x \mid x \subseteq a \}$.
\end{definition}

\section{Singletons}

\begin{definition}[Singleton (Extensionality, Pair Set)]
    Given any $x$, define the \emph{singleton} $\{ x \}$ to be $\{ x, x \}$.    
\end{definition}

\section{Finite Sets}

\begin{definitions}[Extensionality, Pair Set, Union]
    Given any objects $a_1$, \ldots, $a_n$, define the set $\{ a_1, \ldots, a_n \}$ as follows:
    \[ \{ a_1, \ldots, a_n, a_{n+1} \} = \{ a_1, \ldots, a_n \} \cup \{ a_{n+1} \} \enspace . \]
\end{definitions}

\section{Subset Axioms}

\begin{axioms}[Subset Axioms, Aussonderung Axioms]
    For any property $P(x)$ and any set $B$, there exists a set whose members are exactly the sets $x \in B$ such that $P(x)$.
\end{axioms}

\begin{definitions}[Extensionality, Subset]
    For any property $P(x)$ and any set $B$, we write $\{ x \in B \mid P(x) \}$ for $\{x \mid x \in B \wedge P(x) \}$.
\end{definitions}

\begin{theorem}[Subset]
    There is no set to which every set belongs.
\end{theorem}

\begin{proof}
    \pf
    \step{1}{\pflet{$A$ be a set.} \prove{There exists a set that does not belong to $A$.}}
    \step{2}{\pick\ a set $B$ whose members are exactly the sets $x \in A$ such that $x \notin x$.}
    \begin{proof}
        \pf\ By a Subset Axiom.
    \end{proof}
    \step{3}{If $B \in A$ then we have $B \in B \Leftrightarrow B \notin B$}
    \step{4}{$B \notin A$}
    \qed
\end{proof}

\section{Intersection}

\begin{definition}[Intersection (Extensionality, Subset)]
    For any sets $a$ and $b$, the \emph{intersection} $a \cap b$ is $\{ x \in a \mid x \in b \}$.
\end{definition}

\begin{theorem}[Extensionality, Subset]
    For any nonempty set $A$, there exists a unique set $B$ such that, for any $x$, we have $x \in B$ if and only if $x$ belongs to every member of $A$.
\end{theorem}

\begin{proof}
    \pf
    \step{1}{\pflet{$A$ be a nonempty set.}}
    \step{2}{\pick\ $a \in A$}
    \step{3}{\pflet{$B = \{ x \in a \mid \forall y \in A. x \in y \}$}}
    \step{4}{$B$ is the unique set such that, for any $x$, we have $x \in B$ if and only if $x$ belongs to every member of $A$.}
    \qed
\end{proof}

\begin{definition}[Intersection (Extensionality, Subset)]
    For any nonempty set $A$, the \emph{intersection} $\bigcap A$ is the set whose elements are those sets that belong to every member of $A$.
\end{definition}

\section{Relative Complement}

\begin{definition}[Relative Complement (Extensionality, Subset)]
    For any sets $A$ and $B$, the \emph{relative complement} $A - B$ is $\{ x \in A \mid x \notin B \}$.
\end{definition}

\section{Covers}

\begin{definition}[Cover]
    Let $X$ be a set and $\AA \subseteq \pow X$. Then $\AA$ \emph{covers} $X$,
    or is a \emph{covering} of $X$, if and only if $\bigcup \AA = X$.
\end{definition}

\chapter{Relations}

\section{Ordered Pairs}

\begin{definition}[Ordered Pair (Extensionality, Pairing)]
    For any sets $x$ and $y$, the \emph{ordered pair} $(x,y)$ is defined to be $\{ \{ x \}, \{ x , y \} \}$.    
\end{definition}

\begin{theorem}[Extensionality, Pairing]
    For any sets $u$, $v$, $x$, $y$, we have $(u,v) = (x,y)$ if and only if $u = x$ and $v = y$
\end{theorem}

\begin{proof}
    \pf
    \step{1}{\assume{$\{ \{ u \}, \{ u, v \} \} = \{ \{ x \}, \{ x, y \} \}$}}
    \step{2}{$\{ u \} \in \{ \{ x \}, \{ x, y \} \}$}
    \step{3}{$\{ u, v \} \in \{ \{ x \}, \{ x, y \} \}$}
    \step{4}{$\{ u \} = \{ x \}$ or $\{ u \} = \{ x, y \}$}
    \step{5}{$\{ u, v \} = \{ x \}$ or $\{ u, v \} = \{ x, y \}$}
    \step{6}{\case{$\{ u \} = \{ x, y \}$}}
    \begin{proof}
        \step{a}{$u = x = y$}
        \step{b}{$u = v = x = y$}
        \begin{proof}
            \pf\ From \stepref{5}
        \end{proof}
    \end{proof}
    \step{7}{\case{$\{ u, v \} = \{ x \}$}}
    \begin{proof}
        \pf\ Similar.
    \end{proof}
    \step{8}{\case{$\{ u \} = \{ x \}$ and $\{ u, v \} = \{ x, y \}$}}
    \begin{proof}
        \step{a}{$u = x$}
        \step{b}{$u = y$ or $v = y$}
        \step{c}{\case{$u = y$}}
        \begin{proof}
            \pf\ This case is the case considered in \stepref{6}.
        \end{proof}
        \step{d}{\case{$v = y$}}
        \begin{proof}
            \pf\ We have $u = x$ and $v = y$ as required.
        \end{proof}
    \end{proof}
    \qed
\end{proof}

\begin{lemma}[Extensionality, Pairing, Power Set]
    \label{lemma:ordered_pair_pow_pow}
    Let $x$, $y$ and $C$ be sets. If $x \in C$ and $y \in C$ then $(x,y) \in \pow \pow C$.
\end{lemma}

\begin{proof}
    \pf
    \step{1}{\pflet{$x$, $y$ and $C$ be sets.}}
    \step{2}{\assume{$x \in C$}}
    \step{3}{\assume{$y \in C$}}
    \step{4}{$\{ x \} \subseteq C$}
    \step{5}{$\{ x, y \} \subseteq C$}
    \step{6}{$\{ x \} \in \pow C$}
    \step{7}{$\{ x, y \} \in \pow C$}
    \step{8}{$\{ \{ x \}, \{ x, y \} \} \subseteq \pow C$}
    \step{9}{$\{ \{ x \}, \{ x, y \} \} \in \pow \pow C$}
    \qed 
\end{proof}

\begin{lemma}[Extensionality, Pairing, Union]
    \label{lemma:ordered_pair_union_union}
    Let $x$, $y$ and $A$ be sets. If $(x,y) \in A$ then $x$ and $y$ belong to $\bigcup \bigcup A$.
\end{lemma}

\begin{proof}
    \pf
    \step{1}{\pflet{$x$, $y$ and $A$ be sets.}}
    \step{2}{\assume{$(x,y) \in A$}}
    \step{3}{$\{x,y\} \in \bigcup A$}
    \step{4}{$x \in \bigcup \bigcup A$}
    \step{5}{$y \in \bigcup \bigcup A$}
    \qed
\end{proof}

\section{Cartesian Product}

\begin{definition}[Cartesian Product (Extensionality, Pairing, Union, Power Set, Subset)]
    Let $A$ and $B$ be sets. The \emph{Cartesian product} $A \times B$ is the set $\{ (x,y) \mid x \in A, y \in B \}$.

    This is a set since, if $x \in A$ and $y \in B$, then $(x,y) \in \pow \pow (A \cup B)$ by Lemma \ref{lemma:ordered_pair_pow_pow}.
\end{definition}

\section{Relations}

\begin{definition}[Relation (Extensionality, Pairing)]
    A \emph{relation} is a set of ordered pairs.

    Given a relation $R$, we write $xRy$ for $(x,y) \in R$.
\end{definition}

\section{Domain}

\begin{definition}[Domain (Extensionality, Pairing, Union, Subset)]
    Let $R$ be a set. The \emph{domain} of $R$ is $\dom R = \{ x \mid \exists y. (x,y) \in R \}$.

    This is a set by Lemma \ref{lemma:ordered_pair_union_union}.
\end{definition}

\section{Range}

\begin{definition}[Range (Extensionality, Pairing, Union, Subset)]
    Let $R$ be a set. The \emph{range} of $R$ is $\ran R = \{ y \mid \exists x. (x,y) \in R \}$.

    This is a set by Lemma \ref{lemma:ordered_pair_union_union}.
\end{definition}

\section{Field}

\begin{definition}[Field (Extensionality, Pairing, Union, Subset)]
    Let $R$ be a set. The \emph{field} of $R$ is
    $\fld R = \dom R \cup \ran R$.
\end{definition}

\section{Functions}

\begin{definition}[Extensionality, Pairing]
A \emph{function} is a relation $F$ such that, for all $x$, $y$, $y'$, if $xFy$ and $xFy'$ then $y = y'$.

If there exists $x$ such that $xFy$, then we write $F(x)$ for the unique such $y$, and call $F(x)$
the \emph{value} of $F$ at $x$.
\end{definition}

\begin{definition}[Extensionality, Pairing, Union, Subset]
    We write $F : A \rightarrow B$ iff $F$ is a function, $\dom F = A$
    and $\ran F \subseteq B$.
\end{definition}

\begin{axiom}[Axiom of Choice, First Form]
    For any relation $R$, there exists a function $H \subseteq R$ such that 
    $\dom H = \dom R$.
\end{axiom}

\section{Single-Rooted}

\begin{definition}[Extensionality, Pairing]
    A set $R$ is \emph{single-rooted} if and only if, for all $x$, $x'$, $y$, if $xRy$ and $x'Ry$ then $x = x'$.

    We call a function \emph{one-to-one}, \emph{injective} or an \emph{injection}
     if and only if it is single-rooted.
\end{definition}

\section{Surjective}

\begin{definition}[Surjective]
    Let $F : A \rightarrow B$. Then $F$ is \emph{surjective} if and only if
    $\ran F = B$.
\end{definition}

\section{Inverse}

\begin{definition}[Inverse (Extensionality, Pairing, Union, Power Set, Subset)]
    Let $R$ be a set. The \emph{inverse} of $R$ is $\inv{R} = \{ (y,x) \mid (x,y) \in R \}$.

    This is a set because if $(x,y) \in R$ then $(y,x) \in \ran R \times \dom R$.
\end{definition}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    \label{theorem:dom_inv}
    For any set $F$, we have $\dom \inv{F} = \ran F$.
\end{theorem}

\begin{proof}
    \pf\ For any $x$, we have
    \begin{align*}
        x \in \dom \inv{F} & \Leftrightarrow \exists y. (x,y) \in \inv{F} \\
        & \Leftrightarrow \exists y. (y,x) \in F \\
        & \Leftrightarrow x \in \ran F
    \end{align*}
    The result follows by the Axiom of Extensionality. \qed
\end{proof}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    \label{theorem:ran_inv}
    For any set $F$, we have $\ran \inv{F} = \dom F$.
\end{theorem}

\begin{proof}
    \pf\ For any $x$, we have
    \begin{align*}
        x \in \ran \inv{F} & \Leftrightarrow \exists y. (y,x) \in \inv{F} \\
        & \Leftrightarrow \exists y. (x,y) \in F \\
        & \Leftrightarrow x \in \dom F
    \end{align*}
    The result follows by the Axiom of Extensionality. \qed
\end{proof}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    \label{theorem:inv_inv}
    For any relation $F$, we have $\inv{(\inv{F})} = F$.
\end{theorem}

\begin{proof}
    \pf\ For any $z$ we have
    \begin{align*}
        z \in \inv{(\inv{F})} & \Leftrightarrow \exists x, y. z = (x,y) \wedge (y,x) \in \inv{F} \\
        & \Leftrightarrow \exists x,y. z = (x,y) \wedge (x,y) \in F \\
        & \Leftrightarrow z \in F & (\text{$F$ is a relation})
    \end{align*}
    The result follows by the Axiom of Extensionality.
\end{proof}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    \label{theorem:inv_function}
    For any set $F$, we have $\inv{F}$ is a function if and only if $F$ is single-rooted.
\end{theorem}

\begin{proof}
    \pf\ Immediate from definitions. \qed
\end{proof}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    Let $F$ be a relation. Then $F$ is a function if and only if $\inv{F}$ is single-rooted.
\end{theorem}

\begin{proof}
    \pf\ Immediate from definitions. \qed
\end{proof}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    \label{theorem:inv_F_of_F}
    Let $F$ be a one-to-one function and $x \in \dom F$. Then $\inv{F}(F(x)) = x$.
\end{theorem}

\begin{proof}
    \pf\ We have $(x, F(x)) \in F$ and so $(F(x), x) \in \inv{F}$. \qed
\end{proof}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    Let $F$ be a one-to-one function and $y \in \ran F$. Then $F(\inv{F}(y)) = y$.
\end{theorem}

\begin{proof}
    \pf\ From Theorems \ref{theorem:dom_inv}, \ref{theorem:inv_inv} and \ref{theorem:inv_F_of_F}. \qed
\end{proof}

\section{Composition}

\begin{definition}[Composition (Extensionality, Pairing, Union, Power Set, Subset)]
    Let $R$ and $S$ be relations. The \emph{composition} of $R$ and $S$ is $S \circ R = \{ (x,z) \mid \exists y. xRy \wedge ySz \}$.
    
    This is a set because if $xRy$ and $ySz$ then $(x,z) \in \dom R \times \ran S$.
\end{definition}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    \label{theorem:comp_function}
    Let $F$ and $G$ be functions. Then $G \circ F$ is a function, its domain
    is $\{ x \in \dom F \mid F(x) \in \dom G \}$, and for $x$ in this domain,
    we have $(F \circ G)(x) = F(G(x))$.
\end{theorem}

\begin{proof}
    \pf
    \step{1}{$G \circ F$ is a function.}
    \begin{proof}
        \step{a}{\pflet{$x (G \circ F) z$ and $x (G \circ F) z'$}}
        \step{b}{\pick\ $y$, $y'$ such that $x F y$, $x F y'$, $y G z$ and $y' G z'$}
        \step{c}{$y = y'$}
        \begin{proof}
            \pf\ Since $F$ is a function.
        \end{proof}
        \step{d}{$z = z'$}
        \begin{proof}
            \pf\ Since $G$ is a function.
        \end{proof}
    \end{proof}
    \step{2}{$\dom (G \circ F) = \{ x \in \dom F \mid F(x) \in \dom G \}$}
    \begin{proof}
        \pf
        \begin{align*}
            x \in \dom (G \circ F) & \Leftrightarrow \exists z. x(G \circ F)z \\
            & \Leftrightarrow \exists y, z. xFy \wedge yGz \\
            & \Leftrightarrow x \in \dom F \wedge F(x) \in \dom G
        \end{align*}
    \end{proof}
    \step{3}{For $x$ in this domain, we have $(F \circ G)(x) = F(G(x))$.}
    \begin{proof}
        \pf\ Since $(x,F(x)) \in F$ and $(F(x),G(F(x))) \in G$.
    \end{proof}
    \qed
\end{proof}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    For any sets $F$ and $G$, we have $\inv{(G \circ F)} = \inv{F} \circ \inv{G}$.
\end{theorem}

\begin{proof}
    \pf
    \begin{align*}
        (x,z) \in \inv{(G \circ F)} & \Leftrightarrow (z,x) \in G \circ F \\
        & \Leftrightarrow \exists y. zFy \wedge yGx \\
        & \Leftrightarrow \exists y. (y,z) \in \inv{F} \wedge (x,y) \in \inv{G} \\
        & \Leftrightarrow (x,z) \in \inv{F} \circ \inv{G} & \qed
    \end{align*}
\end{proof}

\section{Identity Function}

\begin{definition}[Identity Function (Extensionality, Pairing, Union, Power Set, Subset)]
    Let $A$ be a set. The \emph{identity function} $\id{A}$ on $A$ is
    $\{ (x,x) \mid x \in A \}$.

    This is a set because it is a subset of $A \times A$.
\end{definition}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    Let $F : A \rightarrow B$ and $A$ be nonempty. Then there exists a function
    $G : B \rightarrow A$ such that $G \circ F = \id{A}$ if and only if $F$
    is one-to-one.
\end{theorem}

\begin{proof}
    \pf
    \step{1}{\pflet{$F : A \rightarrow B$}}
    \step{2}{\assume{$A$ is nonempty}}
    \step{3}{If there exists $G : B \rightarrow A$ such that $G \circ F = \id{A}$
    then $F$ is one-to-one.}
    \begin{proof}
        \step{a}{\assume{$G : B \rightarrow A$ and $G \circ F = \id{A}$}}
        \step{b}{\pflet{$x,y \in A$}}
        \step{c}{\assume{$F(x) = F(y)$}}
        \step{d}{$x = y$}
        \begin{proof}
            \pf\ $x = G(F(x)) = G(F(y)) = y$.
        \end{proof}
    \end{proof}
    \step{4}{If $F$ is one-to-one then there exists $G : B \rightarrow A$
    such that $G \circ F = \id{A}$.}
    \begin{proof}
        \step{a}{\assume{$F$ is one-to-one.}}
        \step{b}{\pick\ $a \in A$}
        \step{c}{Define $G : B \rightarrow A$ by: $G(y)$ is the $x$ such
        that $F(x) = y$ if $y \in \ran F$, otherwise $G(y) = a$}
        \step{f}{$G \circ F = \id{A}$}
        \begin{proof}
            \pf\ For $x \in A$ we have $(G \circ F)(x) = G(F(x)) = x$ by Theorem \ref{theorem:comp_function}.
        \end{proof}
    \end{proof}
    \qed
\end{proof}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    Let $F : A \rightarrow B$ and $A$ be nonempty. If there exists a function
    $H : B \rightarrow A$ such that $F \circ H = \id{B}$ then $F$
    is surjective.
\end{theorem}

\begin{proof}
    \pf
    \step{1}{\pflet{$F : A \rightarrow B$}}
    \step{2}{\assume{$A$ is nonempty.}}
    \step{a}{\pflet{$H : B \rightarrow A$ satisfy $F \circ H = \id{B}$}}
    \step{b}{\pflet{$y \in B$}}
    \step{c}{$F(H(y)) = y$.}
    \qed
\end{proof}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset, Choice]
    Let $F : A \rightarrow B$ and $A$ be nonempty. If $F$ is surjective
    then there exists a function $H : B \rightarrow A$ such that $F \circ H = \id{B}$.
\end{theorem}

\begin{proof}
    \pf
    \step{a}{\assume{$F$ is surjective.}}
    \step{b}{\pick\ a function $H \subseteq \inv{F}$ with $\dom H = B$}
    \begin{proof}
        \pf\ By the Axiom of Choice.
    \end{proof}
    \step{c}{$H : B \rightarrow A$}
    \step{d}{$F \circ H = \id{B}$}
    \begin{proof}
        \step{i}{\pflet{$y \in B$}}
        \step{ii}{$(y, H(y)) \in \inv{F}$}
        \step{iii}{$(H(y), y) \in F$}
        \step{iv}{$F(H(y)) = y$}
    \end{proof}
    \qed
\end{proof}

\section{Restriction}

\begin{definition}[Restriction (Extensionality, Pairing, Subset)]
    Let $R$ be a relation and $A$ a set. The \emph{restriction} of $R$ to $A$
    is $R \restriction A = \{ (x,y) \mid x \in A \wedge xRy \}$.

    This is a set because it is a subset of $R$.
\end{definition}

\section{Image}

\begin{definition}[Image (Extensionality, Pairing, Union, Subset)]
    Let $F$ be a function and $A \subseteq \dom F$. The \emph{image} of $A$
    under $F$ is $\{ F(x) \mid x \in A \}$.

    This is a set because it is a subset of $\ran F$.
\end{definition}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    For any sets $F$ and $\AA$ we have
    \[ F \left( \bigcup \AA \right) = \bigcup_{A \in \AA} F(A) \]
\end{theorem}

\begin{proof}
    \pf\ Each is the set of all $y$ such that $\exists x. \exists A.
    x \in A \in \AA \wedge y = F(x)$. \qed
\end{proof}

\begin{corollary}
    For any sets $F$, $A_1$, \ldots, $A_n$, we have
    \[ F(A_1 \cup \cdots \cup A_n) = F(A_1) \cup \cdots \cup F(A_n) \enspace . \]
\end{corollary}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    For any sets $F$ and $\AA$ with $\AA$ nonempty, we have
    \[ F \left( \bigcap \AA \right) \subseteq \bigcap_{A \in \AA} F(A) \enspace . \]
    Equality holds if $F$ is single-rooted.
\end{theorem}

\begin{proof}
    \pf
    \step{a}{$F \left( \bigcap \AA \right) \subseteq \bigcap_{A \in \AA} F(A)$}
    \begin{proof}
        \step{i}{\pflet{$y \in F \left( \bigcap \AA \right)$}}
        \step{ii}{\pick\ $x \in \bigcap \AA$ such that $y = F(x)$}
        \step{iii}{\pflet{$A \in \AA$}}
        \step{iv}{$x \in A$}
        \step{v}{$y \in F(A)$}
    \end{proof}
    \step{b}{If $F$ is single-rooted then $F \left( \bigcap \AA \right) = \bigcap_{A \in \AA} F(A)$}
    \begin{proof}
        \step{i}{\assume{$F$ is single-rooted.}}
        \step{ii}{\pflet{$y \in \bigcap_{A \in \AA} F(A)$}}
        \step{iii}{\pick\ $A \in \AA$}
        \step{iv}{\pick\ $x \in A$ such that $y = F(x)$}
        \step{v}{$x \in \bigcap \AA$}
        \begin{proof}
            \step{one}{\pflet{$A' \in \AA$}}
            \step{two}{\pick\ $x' \in A'$ such that $y = F(x')$}
            \step{three}{$x = x'$}
            \begin{proof}
                \pf\ By \stepref{i}.
            \end{proof}
            \step{four}{$x \in A'$}
        \end{proof}
    \end{proof}
    \qed
\end{proof}

\begin{corollary}[Extensionality, Pairing, Union, Power Set, Subset]
    For any function $F$ and set $\AA$ with $\AA$ nonempty, we have
    \[ \inv{F} \left( \bigcap \AA \right) = \bigcap_{A \in \AA} \inv{F}(A) \enspace . \]
\end{corollary}

\begin{corollary}[Extensionality, Pairing, Union, Power Set, Subset]
    For any sets $F$, $A_1$, \ldots, $A_n$, we have
    \[ F(A_1 \cap \cdots \cap A_n) \subseteq F(A_1) \cap \cdots \cap F(A_n) \enspace . \]
    Equality holds if $F$ is single-rooted.
\end{corollary}

\begin{corollary}[Extensionality, Pairing, Union, Power Set, Subset]
    For any function $F$ and sets $A_1$, \ldots, $A_n$, we have
    \[ \inv{F}(A_1 \cap \cdots \cap A_n) = \inv{F}(A_1) \cap \cdots \cap \inv{F}(A_n) \enspace . \]
\end{corollary}

\begin{theorem}[Extensionality, Pairing, Union, Power Set, Subset]
    For any sets $F$, $A$ and $B$, we have
    \[ F(A) - F(B) \subseteq F(A - B) \enspace . \]
    Equality holds if $F$ is single-rooted.
\end{theorem}

\begin{proof}
    \pf
    \step{1}{\pflet{$F$, $A$ and $B$ be sets.}}
    \step{2}{$F(A) - F(B) \subseteq F(A - B)$}
    \begin{proof}
        \step{a}{\pflet{$y \in F(A) - F(B)$}}
        \step{b}{\pick\ $x \in A$ such that $xFy$}
        \step{c}{$x \in A - B$}
    \end{proof}
    \step{3}{If $F$ is single-rooted then $F(A-B) = F(A) - F(B)$.}
    \begin{proof}
        \step{a}{\assume{$F$ is single-rooted.}}
        \step{b}{\pflet{$y \in F(A-B)$}}
        \step{c}{\pick\ $x \in A - B$ such that $y = F(x)$}
        \step{d}{$y \in F(A)$}
        \step{e}{$y \notin F(B)$}
        \begin{proof}
            \step{i}{\assume{for a contradiction $x' \in B$ and $x'Fy$}}
            \step{ii}{$x' = x$}
            \begin{proof}
                \pf\ From \stepref{a}
            \end{proof}
            \step{iii}{$x \in B$}
            \qedstep
            \begin{proof}
                \pf\ This contradicts \stepref{c}.
            \end{proof}
        \end{proof}
    \end{proof}
    \qed
\end{proof}

\begin{corollary}[Extensionality, Pairing, Union, Power Set, Subset]
    For any function $F$ and sets $A$ and $B$, we have
    \[ \inv{F}(A) - \inv{F}(B) = \inv{F}(A - B) \enspace . \]
\end{corollary}

\section{Infinite Cartesian Product}

\begin{definition}[Infinite Cartesian Product (Extensionality, Pairing, Union, Power Set, Subset)]
    Let $H$ be a function with domain $I$. The \emph{Cartesian product}
    $\prod_{i \in I} H(i)$ is the set of all functions $f$ with domain $I$
    such that, for all $i \in I$, we have $f(i) \in H(i)$.

    This is a set because it is a subset of $\pow(I \times \bigcup \ran H)$.
\end{definition}

\begin{theorem}[Axiom of Choice, Second Version (Extensionality, Pairing, Union, Power Set, Subset)]
    The Axiom of Choice is equivalent to the statement: for any function $H$ with domain $I$,
    if $H(i)$ is nonempty for all $i \in I$, then $\prod_{i \in I} H(i)$ is nonempty.
\end{theorem}

\begin{proof}
    \pf
    \step{1}{If the Axiom of Choice is true then, for any function $H$ with domain $I$,
    if $H(i)$ is nonempty for all $i \in I$, then $\prod_{i \in I} H(i)$ is nonempty.}
    \begin{proof}
        \step{a}{\assume{The Axiom of Choice}}
        \step{b}{\pflet{$H$ be a function with domain $I$ such that $H(i)$ is nonempty for all $i \in I$.}}
        \step{c}{\pick\ a function $f \subseteq \{ (i, x) \mid x \in H(i) \}$}
        \step{d}{$f \in \prod_{i \in I} H(i)$}
    \end{proof}
    \step{2}{If, for any function $H$ with domain $I$,
    if $H(i)$ is nonempty for all $i \in I$, then $\prod_{i \in I} H(i)$ is nonempty,
    then the Axiom of Choice is true.}
    \begin{proof}
        \step{a}{\assume{for any function $H$ with domain $I$,
        if $H(i)$ is nonempty for all $i \in I$, then $\prod_{i \in I} H(i)$ is nonempty}}
        \step{b}{\pflet{$R$ be a relation.}}
        \step{c}{\pflet{$I = \dom R$}}
        \step{d}{\pflet{$H$ be the function with domain $I$ such that $H(i) = \{ y \mid iRy \}$ for all $i$.}}
        \step{e}{\pick\ $f \in \prod_{i \in I} H(i)$}
        \step{f}{$f \subseteq R$}
    \end{proof}
    \qed
\end{proof}

\section{Reflexive Relations}

\begin{definition}[Reflexive (Extensionality, Pairing)]
    Let $R$ be a relation on $A$. Then $R$ is \emph{reflexive} on $A$
    if and only if, for all $x \in A$, we have $xRx$.
\end{definition}

\section{Symmetric}

\begin{definition}[Symmetric (Extensionality, Pairing)]
    Let $R$ be a relation. Then $R$ is \emph{symmetric} if and only if,
    whenever $xRy$, then $yRx$.
\end{definition}

\section{Transitivity}

\begin{definition}[Transitivity (Extensionality, Pairing)]
    Let $R$ be a relation. Then $R$ is \emph{transitive} if and only if,
    whenever $xRy$ and $yRz$, then $xRz$.
\end{definition}

\section{Equivalence Relations}

\begin{definition}[Equivalence Relation (Extensionality, Pairing)]
    Let $R$ be a relation on $A$. Then $R$ is an \emph{equivalence relation}
    on $A$ if and only if $R$ is reflexive on $A$, symmetric and transitive.
\end{definition}

\begin{theorem}[Extensionality, Pairing, Union, Subset]
    If $R$ is a symmetric and transitive relation then $R$ is an equivalence
    relation on $\fld R$.
\end{theorem}

\begin{proof}
    \pf
    \step{1}{\pflet{$R$ be a symmetric and transitive relation.}}
    \step{2}{\pflet{$x \in \fld R$}}
    \step{3}{\pick\ $y$ such that $xRy$ or $yRx$}
    \step{4}{$xRy$ and $yRx$}
    \begin{proof}
        \pf\ By symmetry.
    \end{proof}
    \step{5}{$xRx$}
    \begin{proof}
        \pf\ By transitivity.
    \end{proof}
    \qed
\end{proof}

\section{Equivalence Class}

\begin{definition}[Equivalence Class (Extensionality, Pairing, Subset)]
    Let $R$ be an equivalence relation on $A$ and $a \in A$. Then the
    \emph{equivalence class} of $a$ \emph{modulo} $R$ is
    \[ [a]_R = \{ x \in A \mid aRx \} \enspace . \]
\end{definition}

\begin{lemma}[Extensionality, Pairing, Subset]
    \label{lemma:equivalence_classes}
    Let $R$ be an equivalence relation on $A$ and $x,y \in A$.
    Then $[x]_R = [y]_R$ if and only if $xRy$.
\end{lemma}

\begin{proof}
    \pf
    \step{1}{If $[x]_R = [y]_R$ then $xRy$.}
    \begin{proof}
        \step{a}{\assume{$[x]_R = [y]_R$}}
        \step{b}{$y \in [y]_R$}
        \begin{proof}
            \pf\ Since $yRy$ by reflexivity.
        \end{proof}
        \step{c}{$y \in [x]_R$}
        \step{d}{$xRy$}
    \end{proof}
    \step{2}{If $xRy$ then $[x]_R = [y]_R$.}
    \begin{proof}
        \step{a}{\assume{$xRy$}}
        \step{b}{$[y]_R \subseteq [x]_R$}
        \begin{proof}
            \pf\ If $yRz$ then $xRz$ by transitivity.
        \end{proof}
        \step{c}{$[x]_R \subseteq [y]_R$}
        \begin{proof}
            \pf\ Similar since $yRx$ by symmetry.
        \end{proof}
    \end{proof}
    \qed
\end{proof}

\section{Disjoint}

\begin{definition}[Disjoint]
    Two sets $A$ and $B$ are \emph{disjoint} if and only if there is no $x$
    such that $x \in A$ and $x \in B$.
\end{definition}

\section{Partitions}

\begin{definition}[Partition]
    A \emph{partition} $P$ of a set $A$ is a set of nonempty subsets of $A$ such that:
    \begin{enumerate}
        \item For all $x \in A$ there exists $S \in P$ such that $x \in S$.
        \item Any two distinct elements of $P$ are disjoint.
    \end{enumerate}
\end{definition}

\section{Quotient Sets}

\begin{definition}[Quotient Set (Extensionality, Pairing, Power Set, Subset)]
    Let $R$ be an equivalence relation on $A$. The \emph{quotient set} $A / R$
    is the set of all equivalence classes modulo $R$.

    This is a set because it is a subset of $\pow A$.
\end{definition}

\begin{theorem}[Extensionality, Pairing, Power Set, Subset]
    Let $R$ be an equivalence relation on $A$. Then the quotient set $A / R$
    is a partition of $A$.
\end{theorem}

\begin{proof}
    \pf
    \step{1}{For all $x \in A$ there exists $y \in A$ such that $x \in [y]_R$}
    \begin{proof}
        \pf\ Take $y = x$.
    \end{proof}
    \step{2}{Any two distinct equivalence classes are disjoint.}
    \begin{proof}
        \step{a}{\assume{$z \in [x]_R$ and $z \in [y]_R$}}
        \step{b}{$xRz$ and $yRz$}
        \step{c}{$[x]_R = [z]_R = [y]_R$}
        \begin{proof}
            \pf\ Lemma \ref{lemma:equivalence_classes}.
        \end{proof}
    \end{proof}
    \qed
\end{proof}

\begin{definition}[Canonical Map (Extensionality, Pairing, Power Set, Subset)]
    Let $R$ be an equivalence relation on $A$. The \emph{canonical map} $\phi : A \rightarrow A / R$
    is the function defined by $\phi(a) = [a]_R$.
\end{definition}

\begin{theorem}
    Let $R$ be an equivalence relation on $A$ and $F : A \rightarrow B$.
    Then the following are equivalent:
    \begin{enumerate}
        \item For all $x, y \in A$, if $xRy$ then $F(x) = F(y)$.
        \item There exists $G : A / R \rightarrow B$ such that 
        $F = G \circ \phi$, where $\phi : A \rightarrow A / R$ is the canonical map.
    \end{enumerate}
    In this case, $G$ is unique.
\end{theorem}

\begin{proof}
    \pf
    \step{1}{$1 \Rightarrow 2$}
    \begin{proof}
        \step{a}{\assume{1}}
        \step{b}{Let $G = \{ ([a]_R, b) \mid F(a) = b \}$}
        \step{c}{$G$ is a function.}
        \begin{proof}
            \step{i}{\pflet{$(c,b), (c,b') \in G$}}
            \step{ii}{\pick\ $a, a' \in A$ such that $c = [a]_R = [a']_R$
            with $F(a) = b$ and $F(a') = b'$}
            \step{iii}{$aRa'$}
            \begin{proof}
                \pf\ Lemma \ref{lemma:equivalence_classes}.
            \end{proof}
            \step{iv}{$F(a) = F(a')$}
            \begin{proof}
                \pf\ From \stepref{a}.
            \end{proof}
            \step{v}{$b = b'$}
            \begin{proof}
                \pf\ From \stepref{ii}.
            \end{proof}
        \end{proof}
        \step{d}{$F = G \circ \phi$}
        \begin{proof}
            \pf\ For $a \in A$ we have $G(\phi(a)) = G([a]) = F(a)$.
        \end{proof}
    \end{proof}
    \step{2}{$2 \Rightarrow 1$}
    \begin{proof}
        \step{a}{\pflet{$G : A / R \rightarrow B$ be such that $F = G \circ \phi$}}
        \step{b}{\pflet{$x, y \in A$}}
        \step{c}{\assume{$xRy$}}
        \step{d}{$G([x]) = G([y])$}
        \begin{proof}
            \pf\ Lemma \ref{lemma:equivalence_classes}
        \end{proof}
        \step{d}{$F(x) = F(y)$}
        \begin{proof}
            \pf\ From \stepref{a}.
        \end{proof}
    \end{proof}
    \step{3}{If $G, G' : A / R \rightarrow B$ and $G \circ \phi = G' \circ \phi$
    then $G = G'$}
    \begin{proof}
        \pf\ For any $a \in A$ we have $G([a]) = G'([a])$.
    \end{proof}
    \qed
\end{proof}

\section{The Finite Intersection Property}

\begin{definition}[Finite Intersection Property]
    Let $X$ be a set and $\AA \subseteq \pow X$. Then $\AA$ satisfies the \emph{finite intersection property} if and only if every nonempty finite subset of $\AA$
    has nonempty intersection.
\end{definition}

\begin{lemma}
    \label{lemma:maximal_finite_intersection_property}
    Let $X$ be a set. Let $\AA \subseteq \pow X$ have the finite intersection property.
    Then there exists a maximal set $\DD$ such that $\AA \subseteq \DD \subseteq \pow X$
    and $\DD$ has the finite intersection property.
\end{lemma}

\begin{proof}
    \pf
    \step{1}{\pflet{$\mathbb{F} = \{ \DD \mid \AA \subseteq \DD \subseteq \pow X, \DD \text{ has the finite intersection property} \}$}}
    \step{2}{Every chain in $\mathbb{F}$ has an upper bound.}
    \begin{proof}
        \step{a}{\pflet{$\mathbb{C}$ be a chain in $\mathbb{F}$.}}
        \step{b}{\assume{without loss of generality $\mathbb{C} \neq \emptyset$}
        \prove{$\bigcup \mathbb{C} \in \mathbb{F}$}}
        \begin{proof}
            \pf\ If $\mathbb{C} = \emptyset$ then $\AA$ is an upper bound.
        \end{proof}
        \step{b}{$\AA \subseteq \bigcup \mathbb{C} \subseteq \pow X$}
        \step{c}{\pflet{$C_1, \ldots, C_n \in \mathbb{C}$} \prove{$C_1 \cap \cdots \cap C_n \neq \emptyset$}}
        \step{d}{\pick\ $\mathcal{C}_1, \ldots, \mathcal{C}_n \in \mathbb{C}$ such that $C_i \in \mathcal{C}_i$ for all $i$.}
        \step{e}{\assume{without loss of generality $\mathcal{C}_1 \subseteq \cdots \subseteq \mathcal{C}_n$}}
        \step{f}{$C_1, \ldots, C_n \in \mathcal{C}_n$}
        \step{g}{$\mathcal{C}_n$ satisfies the finite intersection property.}
        \step{h}{$C_1 \cap \cdots \cap C_n \neq \emptyset$}
    \end{proof}
    \qedstep
    \begin{proof}
        \pf\ By Zorn's Lemma.
    \end{proof}
    \qed
\end{proof}

\begin{lemma}
    \label{lemma:finite_intersection_maximal}
    Let $X$ be a set. Let $\DD \subseteq \pow X$ be maximal with respect to the finite intersection property.
    Then any finite intersection of elements of $\DD$ is an element of $\DD$.
\end{lemma}

\begin{proof}
    \pf
    \step{1}{\pflet{$D_1, D_2 \in \DD$}}
    \step{2}{$\DD \cup \{ D_1 \cap D_2 \}$ has the finite intersection property.}
    \begin{proof}
        \pf\ Any finite intersection of members of $\DD \cup \{ D_1 \cap D_2 \}$
        is a finite intersection of members of $\DD$.
    \end{proof}
    \step{3}{$\DD = \DD \cup \{ D_1 \cap D_2 \}$}
    \begin{proof}
        \pf\ By maximality of $\DD$.
    \end{proof}
    \step{4}{$D_1 \cap D_2 \in \DD$.}
    \qed
\end{proof}

\begin{lemma}
    \label{lemma:member_maximal_finite_intersection}
    Let $X$ be a set. Let $\DD \subseteq \pow X$ be maximal with respect to the finite intersection property.
    Let $A \subseteq X$. If $A$ intersects every member of $\DD$ then $A \in \DD$.
\end{lemma}

\begin{proof}
    \pf
    \step{1}{$\DD \cup \{ A \}$ has the finite intersection property.}
    \begin{proof}
        \step{a}{\pflet{$D_1, \ldots, D_n \in \DD$} \prove{$D_1 \cap \cdots \cap D_n \cap A \neq \emptyset$}}
        \step{b}{$D_1 \cap \cdots \cap D_n \in \DD$}
        \begin{proof}
            \pf\ Lemma \ref{lemma:finite_intersection_maximal}.
        \end{proof}
        \step{c}{$D_1 \cap \cdots \cap D_n \cap A \neq \emptyset$}
        \begin{proof}
            \pf\ Since $A$ intersects every member of $\DD$.
        \end{proof}
    \end{proof}
    \qedstep
    \begin{proof}
        \pf\ By maximality of $\DD$.
    \end{proof}
    \qed
\end{proof}

\begin{proposition}
    Let $X$ be a set. Let $\DD \subseteq \pow X$ be maximal with respect to the
    finite intersection property. Let $A, D \in \pow X$.
    If $D \in \DD$ and $D \subseteq A$ then $A \in \DD$.
\end{proposition}

\begin{proof}
    \pf
    \step{1}{$\DD \cup \{A\}$ satisfies the finite intersection property.}
    \begin{proof}
        \step{a}{\pflet{$D_1, \ldots, D_n \in \DD$}}
        \step{b}{$D_1 \cap \cdots \cap D_n \cap D \neq \emptyset$}
        \begin{proof}
            \pf\ Since $\DD$ satisfies the finite intersection property.
        \end{proof}
        \step{c}{$D_1 \cap \cdots \cap D_n \cap A \neq \emptyset$}
    \end{proof}
    \step{2}{$\DD = \DD \cup \{A\}$}
    \begin{proof}
        \pf\ By the maximality of $\DD$.
    \end{proof}
    \step{3}{$A \in \DD$}
    \qed
\end{proof}

\begin{definition}[Graph]
    Let $f : A \rightarrow B$. The \emph{graph} of $f$ is the set $\{ (x, f(x)) \mid x \in A \} \subseteq A \times B$.
\end{definition}

\section{Countable Intersection Property}

\begin{definition}[Countable Intersection Property]
    Let $X$ be a set and $\AA \subseteq \pow X$. Then $\AA$ satisfies the \emph{countable intersection property}
    if and only if every countable subset of $\AA$ has nonempty intersection.
\end{definition}

\begin{lemma}
    \label{lemma:countable_intersection_maximal}
    Let $X$ be a set. Let $\DD \subseteq \pow X$ be maximal with respect to the countable intersection property.
    Then any countable intersection of elements of $\DD$ is an element of $\DD$.
\end{lemma}

\begin{proof}
    \pf
    \step{1}{\pflet{$\DD_0 \subseteq \DD$ be countable.}}
    \step{2}{$\DD \cup \{ \bigcap \DD_0 \}$ has the countable intersection property.}
    \begin{proof}
        \pf\ Any countable intersection of members of $\DD \cup \{ \bigcap \DD_0 \}$
        is a finite intersection of members of $\DD$.
    \end{proof}
    \step{3}{$\DD = \DD \cup \{ \bigcap \DD_0 \}$}
    \begin{proof}
        \pf\ By maximality of $\DD$.
    \end{proof}
    \step{4}{$\bigcap \DD_0 \in \DD$.}
    \qed
\end{proof}

\begin{lemma}
    Let $X$ be a set. Let $\DD \subseteq \pow X$ be maximal with respect to the countable intersection property.
    Let $A \subseteq X$. If $A$ intersects every member of $\DD$ then $A \in \DD$.
\end{lemma}

\begin{proof}
    \pf
    \step{1}{$\DD \cup \{ A \}$ has the countable intersection property.}
    \begin{proof}
        \step{a}{\pflet{$\DD_0 \subseteq \DD$ be countable.}
        \prove{$\bigcap \DD_0 \cap A \neq \emptyset$}}
        \step{b}{$\bigcap \DD_0 \in \DD$}
        \begin{proof}
            \pf\ Lemma \ref{lemma:countable_intersection_maximal}.
        \end{proof}
        \step{c}{$\bigcap \DD_0 \cap A \neq \emptyset$}
        \begin{proof}
            \pf\ Since $A$ intersects every member of $\DD$.
        \end{proof}
    \end{proof}
    \qedstep
    \begin{proof}
        \pf\ By maximality of $\DD$.
    \end{proof}
    \qed
\end{proof}

\section{The Axiom of Choice}

\begin{axiom}[Axiom of Choice]
    Let $\AA$ be a set of disjoint nonempty sets. Then there exists a set $C$ consisting of exactly one element from each member of $\AA$.
\end{axiom}

\section{Choice Functions}

\begin{definition}[Choice Function]
    Let $\BB$ be a set of nonempty sets. A \emph{choice function} for $\BB$ is a function $c : \BB \rightarrow \bigcup \BB$ such that, for all $B \in \BB$,
    we have $c(B) \in B$.
\end{definition}

\begin{lemma}[Existence of a Choice Function (AC)]
    \label{lemma:choice_function}
    Every set of nonempty sets has a choice function.
\end{lemma}

\begin{proof}
    \pf
    \step{1}{\pflet{$\BB$ be a set of nonempty sets.}}
    \step{2}{For $B \in \BB$, \pflet{$B' = \{ B \} \times B$}}
    \step{3}{$\{ B' \mid B \in \BB \}$ is a set of disjoint nonempty sets.}
    \step{4}{\pick\ a set $c$ consisting of exactly one element from each $B'$ for $B \in \BB$.}
    \step{5}{$c$ is a choice function for $\BB$.}
    \qed
\end{proof}